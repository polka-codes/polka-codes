// generated by polka.codes
import { describe, expect, it } from 'bun:test'
import { dirname, join } from './path'

describe('dirname', () => {
  it('should return dot for empty string', () => {
    expect(dirname('')).toBe('.')
  })

  it('should return dot for simple filename', () => {
    expect(dirname('file.txt')).toBe('.')
  })

  it('should return directory for simple path', () => {
    expect(dirname('dir/file.txt')).toBe('dir')
  })

  it('should handle nested paths', () => {
    expect(dirname('a/b/c/file.txt')).toBe('a/b/c')
  })

  it('should return root for file at root', () => {
    expect(dirname('/file.txt')).toBe('/')
  })

  it('should handle root directory', () => {
    expect(dirname('/')).toBe('/')
  })

  it('should handle absolute paths', () => {
    expect(dirname('/home/user/file.txt')).toBe('/home/user')
  })

  it('should strip trailing slashes', () => {
    expect(dirname('dir/')).toBe('.')
    expect(dirname('dir/subdir/')).toBe('dir')
    expect(dirname('/dir/subdir/')).toBe('/dir')
  })

  it('should handle multiple trailing slashes', () => {
    expect(dirname('dir///')).toBe('.')
  })
})

describe('join', () => {
  it('should return dot for no arguments', () => {
    expect(join()).toBe('.')
  })

  it('should return single argument as-is', () => {
    expect(join('file.txt')).toBe('file.txt')
  })

  it('should join two parts', () => {
    expect(join('dir', 'file.txt')).toBe('dir/file.txt')
  })

  it('should join multiple parts', () => {
    expect(join('a', 'b', 'c')).toBe('a/b/c')
  })

  it('should handle absolute paths', () => {
    expect(join('/home', 'user')).toBe('/home/user')
  })

  it('should normalize dots', () => {
    expect(join('a', '.', 'b')).toBe('a/b')
  })

  it('should normalize double dots', () => {
    expect(join('a', 'b', '..', 'c')).toBe('a/c')
  })

  it('should handle double dots at start', () => {
    expect(join('..', 'a')).toBe('../a')
  })

  it('should handle empty segments', () => {
    expect(join('a', '', 'b')).toBe('a/b')
  })

  it('should throw for non-string arguments', () => {
    expect(() => join(123 as any)).toThrow('Arguments to join must be strings')
  })

  it('should handle leading slashes in non-first parts', () => {
    expect(join('/home', '/user')).toBe('/home/user')
  })

  it('should handle trailing slashes', () => {
    expect(join('a/', 'b')).toBe('a/b')
  })

  it('should handle complex normalization', () => {
    expect(join('a', '../b', './c')).toBe('b/c')
  })

  it('should handle absolute path with parent references', () => {
    expect(join('/a/b', '../c')).toBe('/a/c')
  })

  it('should not go above root for absolute paths', () => {
    expect(join('/', '..')).toBe('/')
  })
})
