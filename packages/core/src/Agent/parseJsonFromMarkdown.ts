// generated by polka.codes
export const parseJsonFromMarkdown = (markdown: string): any => {
  const jsonRegex = /```(?:json)?\n([\s\S]*?)\n```/
  const match = markdown.match(jsonRegex)

  if (match?.[1]) {
    const content = match[1].trim()
    let parsed = JSON.parse(content)

    if (typeof parsed === 'string') {
      try {
        parsed = JSON.parse(parsed)
      } catch {
        // ignore
      }
    }
    return parsed
  }

  // Fallback for cases where the output is just the JSON string without markdown fences
  try {
    return JSON.parse(markdown)
  } catch (_error) {
    // not a json, return original string
  }

  return markdown
}
