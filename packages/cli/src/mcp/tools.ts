// generated by polka.codes

import type { ToolSet } from 'ai'
import type { McpManager } from './manager'

/**
 * Create AI SDK tools from MCP server connections
 */
export function createMcpTools(mcpManager: McpManager): ToolSet {
  const tools: ToolSet = {}

  const allMcpTools = mcpManager.getAllTools()

  for (const [fullToolName, { tool }] of allMcpTools) {
    tools[fullToolName] = {
      description: tool.description || `MCP tool: ${tool.name}`,
      inputSchema: tool.inputSchema as any,
      execute: async (args: Record<string, unknown>) => {
        return await mcpManager.callTool(fullToolName, args)
      },
    }
  }

  return tools
}

/**
 * Get list of MCP tool names for a given server
 */
export function getMcpToolNames(mcpManager: McpManager, serverName?: string): string[] {
  if (serverName) {
    const serverTools = mcpManager.getServerTools(serverName)
    return Array.from(serverTools.keys())
  }

  const allTools = mcpManager.getAllTools()
  return Array.from(allTools.keys())
}
