// generated by polka.codes
import { Command } from 'commander'
import { fix } from '../api'
import { getBaseWorkflowOptions } from '../utils/command'

export const fixCommand = new Command('fix')
  .description('Fix issues by running a command and letting an agent fix it.')
  .argument('[command]', 'The command to run')
  .option('-p, --prompt <prompt>', 'Additional prompt for the agent.')
  .action(async (commandArg: string | undefined, options: { prompt?: string }, cmd: Command) => {
    const workflowOpts = getBaseWorkflowOptions(cmd)
    await fix({
      command: commandArg,
      prompt: options.prompt,
      ...workflowOpts,
    })
  })
