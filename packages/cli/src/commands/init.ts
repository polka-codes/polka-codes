/**
 * Initialize polkacodes configuration command.
 * Generated by polka.codes
 */

import { Command } from 'commander'
import { createLogger } from '../logger'
import { runWorkflow } from '../runWorkflow'
import { initWorkflow } from '../workflows/init.workflow'

export const initCommand = new Command('init')
  .description('Initialize polkacodes configuration')
  .option('-g, --global', 'Use global config')
  .action(async (options, command: Command) => {
    const globalOpts = (command.parent ?? command).opts()
    const { verbose } = globalOpts
    const logger = createLogger({
      verbose: verbose,
    })
    await runWorkflow(
      initWorkflow,
      {
        global: options.global,
        parentOptions: command.parent?.opts() ?? {},
      },
      {
        commandName: 'init',
        command,
        logger,
        requiresProvider: false,
      },
    )
  })
